<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุธุงู ูุฑุด ุงูุฐูู | ุงููุทูุฑ ูุตุทูู ุนุจุฏ ุงููู</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <style>
        :root { --p: #1e4d2b; --g: #d4af37; --bg: #f4f7f6; --card: #ffffff; --txt: #333; --accent: #2ecc71; }
        .theme-dark { --p: #121212; --g: #bb86fc; --bg: #000; --card: #1e1e1e; --txt: #e0e0e0; }
        .theme-blue { --p: #1a237e; --g: #00bcd4; --bg: #e8eaf6; --card: #fff; --txt: #1a237e; }
        .theme-gold { --p: #3e2723; --g: #d4af37; --bg: #efebe9; --card: #fff; --txt: #3e2723; }
        .theme-tech { --p: #003366; --g: #00ffcc; --bg: #000b18; --card: #001a33; --txt: #00ffcc; }

        * { box-sizing: border-box; font-family: 'Tajawal', sans-serif; transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        body { background: var(--bg); color: var(--txt); margin: 0; padding: 10px; direction: rtl; }
        .card { background: var(--card); border-radius: 25px; padding: 30px; box-shadow: 0 15px 35px rgba(0,0,0,0.2); margin: 10px auto; max-width: 600px; border: 1px solid rgba(255,255,255,0.1); position: relative; overflow: hidden; }
        .btn { padding: 15px; border: none; border-radius: 15px; cursor: pointer; font-weight: bold; width: 100%; margin: 8px 0; font-size: 16px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-p { background: linear-gradient(135deg, var(--p), #2a633a); color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        input, select, textarea { width: 100%; padding: 14px; margin: 10px 0; border: 2px solid #ddd; border-radius: 12px; font-size: 15px; background: #fff; color: #333; outline: none; }
        input:focus { border-color: var(--g); box-shadow: 0 0 10px rgba(212,175,55,0.3); }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 12px; }
        .grid-item { background: var(--p); color: white; padding: 15px; border-radius: 15px; cursor: pointer; text-align: center; border: 1px solid var(--g); font-size: 13px; }
        .badge-info { background: rgba(0,0,0,0.05); padding: 15px; border-radius: 15px; margin: 10px 0; font-size: 12px; line-height: 1.6; border-right: 4px solid var(--g); }
        .history-item { background: rgba(0,0,0,0.02); padding: 15px; border-radius: 15px; margin-bottom: 10px; border: 1px solid #eee; }
        .mustafa-tag { font-size: 12px; font-weight: bold; color: var(--g); text-align: center; margin: 10px 0; }
        .search-box { position: sticky; top: 0; z-index: 100; background: var(--bg); padding: 10px 0; }
        .top-ten-list { display: none; background: gold; color: #000; padding: 15px; border-radius: 15px; margin-top: 10px; }
    </style>
</head>
<body class="theme-default">

<div id="app">
    <div id="mainMenu" class="card">
        <div class="mustafa-tag">ุชู ุงูุชุทููุฑ ูุงูุจุฑูุฌุฉ ุจูุงุณุทุฉ ุงููุจุฑูุฌ ูุตุทูู ุนุจุฏ ุงููู</div>
        <h2 style="text-align:center;">ูุฏุฑุณุฉ ุงูุฅูุงู ูุฑุด ุงูุฐููุฉ ๐ก๏ธ</h2>
        <p style="text-align:center; font-size:13px;">ูุทูุงูุ ุงุฎุชุฑ ุงูุณูุฉ ุงูุชู ุชูุงุณุจ ุฐููู:</p>
        <div style="display:flex; gap:10px; justify-content:center; margin-bottom:20px;">
            <div onclick="setTheme('default')" style="width:30px;height:30px;border-radius:50%;background:#1e4d2b;cursor:pointer;border:2px solid #fff"></div>
            <div onclick="setTheme('dark')" style="width:30px;height:30px;border-radius:50%;background:#000;cursor:pointer;border:2px solid #fff"></div>
            <div onclick="setTheme('blue')" style="width:30px;height:30px;border-radius:50%;background:#1a237e;cursor:pointer;border:2px solid #fff"></div>
            <div onclick="setTheme('gold')" style="width:30px;height:30px;border-radius:50%;background:#3e2723;cursor:pointer;border:2px solid #fff"></div>
            <div onclick="setTheme('tech')" style="width:30px;height:30px;border-radius:50%;background:#003366;cursor:pointer;border:2px solid #fff"></div>
        </div>
        <input type="text" id="studentCode" placeholder="ุฃุฏุฎู ููุชุงุญ ุงูุฏุฎูู ุงูุฎุงุต ุจู">
        <button class="btn btn-p" onclick="studentLogin()">ุฏุฎูู ุงูุทุงูุจ ๐ค</button>
        <button class="btn" style="background:#455a64; color:white" onclick="showScreen('staffLogin')">ุจูุงุจุฉ ุงููุงุฏุฑ ุงูุฅุฏุงุฑู ูุงูุชุนูููู ๐</button>
        <div style="text-align:center; margin-top:20px; font-size:11px;">
            ุญููู ุงูุจุฑูุฌุฉ: ูุตุทูู ุนุจุฏ ุงููู ุฃุญูุฏ<br>
            ุงูููุฑุฉ ูุงูุชุตููู: ูุฒู ุฃูุณ & ูุญูุฏ ุนูู
        </div>
    </div>

    <div id="studentPage" class="hidden card">
        <div class="mustafa-tag">ุงููุจุฑูุฌ ุงููุทูุฑ: ูุตุทูู ุนุจุฏ ุงููู</div>
        <h3 id="welcomeMsg"></h3>
        <div id="delayBox" style="background:#ffebee; color:#c62828; padding:10px; border-radius:10px; margin-bottom:10px; display:none; font-weight:bold; font-size:13px;"></div>
        
        <button class="btn" style="background:gold; color:black;" onclick="toggleTopTen()">๐ ุนุฑุถ ูุงุฆูุฉ ุงูุนุดุฑุฉ ุงูุฃูุงุฆู</button>
        <div id="topTenList" class="top-ten-list"></div>

        <div style="background:var(--p); color:white; padding:15px; border-radius:15px; margin:15px 0; text-align:center;">
            <small>ุฅูุฌุงุฒ ุงูุฃุณุจูุน ุงูุญุงูู</small>
            <h2 id="weekCounter">0 / 0</h2>
        </div>

        <h4>ุณุฌู ุงูุชุณููุน ุงูุฏุงุฆู (ุงูุฃุฑุดูู):</h4>
        <div id="recordsList" style="max-height:300px; overflow-y:auto;"></div>

        <div class="badge-info">
            <b>ุชูููู ูููุตุทูุญุงุช:</b><br>
            โข <b>ูู ูุณูุน:</b> ุงูุทุงูุจ ุญุถุฑ ูู ููุฒูู ููู ูุญูุธ ุดูุฆุงู.<br>
            โข <b>ุบูุฑ ุญุงูุธ:</b> ุงูุทุงูุจ ุญุงูู ุงูุชุณููุน ูููู ุฃุฎุทุงุคู ูุซูุฑุฉ ููุนุชู ูู ุงูุงุฌุชูุงุฒ.<br>
            โข <b>ูุญุฑูู:</b> ูู ููุชุซู ููููุงููู ุฃู ุชุฃุฎุฑ ุนู ููุนุฏู.<br>
            โข <b>ุบุงุฆุจ:</b> ูู ูุญุถุฑ ุงูุญุตุฉ ุฃุณุงุณุงู.
        </div>
        <button class="btn btn-p" onclick="showScreen('mainMenu')">ุฎุฑูุฌ</button>
    </div>

    <div id="teacherDash" class="hidden card" style="max-width:850px;">
        <div class="mustafa-tag">ููุญุฉ ุงูุชุญูู ุงููุงููุฉ - ุชุทููุฑ ูุตุทูู ุนุจุฏ ุงููู</div>
        <h3>ูุฑุญุจุงู ุฃุณุชุงุฐ ุณุนุฏ ๐๏ธ</h3>
        <div class="search-box">
            <input type="text" id="searchStudent" placeholder="๐ ุงุจุญุซ ุนู ุงุณู ุงูุทุงูุจ ููุฑุงู..." oninput="filterStudents()">
        </div>
        <div style="display:flex; gap:10px; margin-bottom:15px;">
            <button class="btn btn-p" onclick="loadClass('3/1')">ูุตู 3/1</button>
            <button class="btn btn-p" onclick="loadClass('3/2')">ูุตู 3/2</button>
        </div>
        <div id="namesGrid" class="grid"></div>
        <hr>
        <button class="btn" style="background:#607d8b; color:white" onclick="showManageStudents()">ุฅุฏุงุฑุฉ ุงูุทูุงุจ (ุฅุถุงูุฉ/ุญุฐู)</button>
        <button class="btn" onclick="resetTopTen()">ุชุตููุฑ ูุงุฆูุฉ ุงูุฃูุงุฆู</button>
        <button class="btn" onclick="showScreen('mainMenu')">ุชุณุฌูู ุฎุฑูุฌ</button>
    </div>

    <div id="gradeScreen" class="hidden card">
        <h3 id="targetName"></h3>
        <div class="mustafa-tag">ุฑุตุฏ ุขูู ููุจุงุดุฑ - ุจุฑูุฌุฉ ูุตุทูู</div>
        
        <label>ุงุฎุชุฑ ุงูุฃุณุจูุน:</label>
        <select id="gWeek">
            <option value="ุงูุฃุณุจูุน ุงูุฃูู">ุงูุฃุณุจูุน ุงูุฃูู</option>
            <option value="ุงูุฃุณุจูุน ุงูุซุงูู">ุงูุฃุณุจูุน ุงูุซุงูู</option>
            <option value="ุงูุฃุณุจูุน ุงูุซุงูุซ">ุงูุฃุณุจูุน ุงูุซุงูุซ</option>
            <option value="ุงูุฃุณุจูุน ุงูุฑุงุจุน">ุงูุฃุณุจูุน ุงูุฑุงุจุน</option>
            <option value="ุงูุฃุณุจูุน ุงูุฎุงูุณ">ุงูุฃุณุจูุน ุงูุฎุงูุณ</option>
            </select>

        <label>ุงุฎุชุฑ ุงูููู:</label>
        <select id="gDay">
            <option value="ุงูุฃุญุฏ">ุงูุฃุญุฏ</option>
            <option value="ุงูุฅุซููู">ุงูุฅุซููู</option>
            <option value="ุงูุซูุงุซุงุก">ุงูุซูุงุซุงุก</option>
            <option value="ุงูุฃุฑุจุนุงุก">ุงูุฃุฑุจุนุงุก</option>
            <option value="ุงูุฎููุณ">ุงูุฎููุณ</option>
        </select>

        <input type="number" id="gPage" placeholder="ุฑูู ุงูุตูุญุฉ (ูุฏูู)">
        <input type="number" id="gMark" max="7" placeholder="ุงูุฏุฑุฌุฉ ูู 7 (ูุฏูู)">

        <label>ุงูุญุงูุฉ:</label>
        <select id="gStatus">
            <option value="ุญุงูุธ">ุญุงูุธ โ</option>
            <option value="ุบูุฑ ุญุงูุธ">ุบูุฑ ุญุงูุธ โ๏ธ</option>
            <option value="ูู ูุณูุน">ูู ูุณูุน โ</option>
            <option value="ูุญุฑูู">ูุญุฑูู ๐ซ</option>
            <option value="ุบุงุฆุจ">ุบุงุฆุจ ๐ค</option>
        </select>
        
        <textarea id="gNote" placeholder="ููุงุญุธุงุช ุงุฎุชูุงุฑูุฉ (ุฅุฌุจุงุฑูุฉ ุนูุฏ ุงูุชูุตูุฑ)"></textarea>
        
        <button class="btn btn-p" onclick="saveGrade()">ุญูุธ ูุฑุตุฏ ูู ุณุฌู ุงูุทุงูุจ</button>
        <div id="historyListTeacher" style="margin-top:15px; max-height:150px; overflow-y:auto;"></div>
        <button class="btn" onclick="showScreen('teacherDash')">ุฑุฌูุน</button>
    </div>

    <div id="adminDash" class="hidden card" style="max-width:900px;">
        <h3>ุชูุงุฑูุฑ ุงูุฅุฏุงุฑุฉ ูุงููุชุงุจุนุฉ ๐</h3>
        <div class="mustafa-tag">ูุธุงู ุงูุฅุฏุงุฑุฉ ุงููุทูุฑ - ูุตุทูู ุนุจุฏ ุงููู</div>
        <div style="display:flex; gap:10px; margin-bottom:15px;">
            <button class="btn btn-p" onclick="renderAdminDash('3/1')">ูุตู 3/1</button>
            <button class="btn btn-p" onclick="renderAdminDash('3/2')">ูุตู 3/2</button>
        </div>
        <div id="adminContainer"></div>
        <button class="btn btn-p" onclick="showScreen('mainMenu')">ุฎุฑูุฌ</button>
    </div>

    <div id="manageStudentsPage" class="hidden card">
        <h3>ุฅุถุงูุฉ ุทุงูุจ ุฌุฏูุฏ</h3>
        <input type="text" id="newSName" placeholder="ุงุณู ุงูุทุงูุจ ุงูุซูุงุซู">
        <input type="text" id="newSCode" placeholder="ููุชุงุญ ุฏุฎูู ุงูุทุงูุจ">
        <select id="newSClass"><option value="3/1">3/1</option><option value="3/2">3/2</option></select>
        <button class="btn btn-p" onclick="addNewStudent()">ุฅุถุงูุฉ ุฅูู ุงููุธุงู</button>
        <div id="adminStudentsList" style="margin-top:20px;"></div>
        <button class="btn" onclick="showScreen('teacherDash')">ุฑุฌูุน</button>
    </div>

    <div id="staffLogin" class="hidden card">
        <input type="text" id="user" placeholder="ุงุณู ุงููุณุชุฎุฏู">
        <input type="password" id="pass" placeholder="ูููุฉ ุงููุฑูุฑ">
        <button class="btn btn-p" onclick="staffAuth()">ุฏุฎูู ุงููุงุฏุฑ</button>
        <button class="btn" onclick="showScreen('mainMenu')">ุฑุฌูุน</button>
    </div>
</div>

<footer style="text-align:center; padding:20px; font-size:11px; color:#888;">
    <b>ุงููุทูุฑ ูุงููุจุฑูุฌ ุงููุนุชูุฏ: ูุตุทูู ุนุจุฏ ุงููู ุฃุญูุฏ</b><br>
    ูุฑูู ุงูุนูู: ูุฒู ุฃูุณุ ูุญูุฏ ุนูู | ุงูุฏุนู ุงูููู: 0599804296
</footer>

<script>
    const firebaseConfig = { apiKey: "AIzaSyAC9BzBpw66oBDriZoi9A5zsThKLFZiNv8", databaseURL: "https://imam-warsh-default-rtdb.asia-southeast1.firebasedatabase.app" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let students = []; let currentSID = null; let currentClass = '3/1';

    // ุชุนุจุฆุฉ ุงูุฃุณุงุจูุน ูุบููุงู
    const weekSelect = document.getElementById('gWeek');
    const weeksArabic = ["ุงูุฃูู","ุงูุซุงูู","ุงูุซุงูุซ","ุงูุฑุงุจุน","ุงูุฎุงูุณ","ุงูุณุงุฏุณ","ุงูุณุงุจุน","ุงูุซุงูู","ุงูุชุงุณุน","ุงูุนุงุดุฑ",
                        "ุงูุญุงุฏู ุนุดุฑ","ุงูุซุงูู ุนุดุฑ","ุงูุซุงูุซ ุนุดุฑ","ุงูุฑุงุจุน ุนุดุฑ","ุงูุฎุงูุณ ุนุดุฑ","ุงูุณุงุฏุณ ุนุดุฑ","ุงูุณุงุจุน ุนุดุฑ","ุงูุซุงูู ุนุดุฑ","ุงูุชุงุณุน ุนุดุฑ","ุงูุนุดุฑูู",
                        "ุงูุญุงุฏู ูุงูุนุดุฑูู","ุงูุซุงูู ูุงูุนุดุฑูู","ุงูุซุงูุซ ูุงูุนุดุฑูู","ุงูุฑุงุจุน ูุงูุนุดุฑูู","ุงูุฎุงูุณ ูุงูุนุดุฑูู","ุงูุณุงุฏุณ ูุงูุนุดุฑูู","ุงูุณุงุจุน ูุงูุนุดุฑูู","ุงูุซุงูู ูุงูุนุดุฑูู","ุงูุชุงุณุน ูุงูุนุดุฑูู","ุงูุซูุงุซูู"];
    weekSelect.innerHTML = weeksArabic.map(w => `<option value="ุงูุฃุณุจูุน ${w}">ุงูุฃุณุจูุน ${w}</option>`).join('');

    db.ref('students').on('value', s => { students = s.exists() ? Object.values(s.val()) : []; });

    function setTheme(t) { document.body.className = t === 'default' ? '' : 'theme-' + t; }

    function studentLogin() {
        const code = document.getElementById('studentCode').value.trim();
        const s = students.find(x => x.code === code);
        if(s) { renderStudentPage(s); showScreen('studentPage'); }
        else alert('ููุชุงุญ ุงูุฏุฎูู ุบูุฑ ุตุญูุญ!');
    }

    function renderStudentPage(s) {
        document.getElementById('welcomeMsg').innerHTML = `ุฃููุงู ุจู ูุง <b>${s.name}</b> ๐`;
        const recs = s.records || [];
        
        // ุงููุชุฃุฎุฑุงุช
        const delays = recs.filter(r => ['ุบูุฑ ุญุงูุธ','ูุญุฑูู','ูู ูุณูุน'].includes(r.status)).length;
        if(delays > 0) {
            document.getElementById('delayBox').style.display = 'block';
            document.getElementById('delayBox').innerText = `ุชูุจูู: ูุฏูู ${delays} ุฏุฑูุณ ูุชุฃุฎุฑุฉ ูุฌุจ ุชุณููุนูุง ููุฃุณุชุงุฐ ุณุนุฏ.`;
        }

        document.getElementById('recordsList').innerHTML = recs.map(r => `
            <div class="history-item" style="border-right: 5px solid ${getColor(r.status)}">
                <div style="display:flex; justify-content:space-between">
                    <b>${r.week} - ${r.day}</b>
                    <b style="color:var(--p)">${r.mark}/7</b>
                </div>
                <div style="font-size:12px; margin:5px 0;">ุงูุตูุญุฉ: ${r.page} | ุงูุญุงูุฉ: ${r.status}</div>
                ${r.prevStatus ? `<div style="font-size:10px; color:red;">(ุชู ุงูุชุณููุน - ุงูุญุงูุฉ ุงูุฃุตููุฉ: ${r.prevStatus})</div>` : ''}
                <div style="font-size:11px; color:#666 italic">${r.note || ''}</div>
            </div>
        `).reverse().join('');
    }

    function saveGrade() {
        const s = students.find(x => x.id == currentSID);
        const week = document.getElementById('gWeek').value;
        const page = document.getElementById('gPage').value;
        const status = document.getElementById('gStatus').value;
        const mark = document.getElementById('gMark').value;
        const note = document.getElementById('gNote').value;

        if(!mark || !page) return alert('ูุฑุฌู ุฑุตุฏ ุงูุตูุญุฉ ูุงูุฏุฑุฌุฉ ูุฏููุงู');
        if(['ุบูุฑ ุญุงูุธ','ูุญุฑูู','ูู ูุณูุน','ุบุงุฆุจ'].includes(status) && !note) return alert('ุงูููุงุญุธุฉ ุฅุฌุจุงุฑูุฉ ูู ุญุงู ุนุฏู ุงูุฅุฌุชูุงุฒ!');

        if(!s.records) s.records = [];
        
        // ููุทู "ุงูุญุงูุฉ ุงูุณุงุจูุฉ"
        const existingIdx = s.records.findIndex(r => r.week === week && r.page === page);
        let prevStatus = null;
        if(existingIdx !== -1) {
            prevStatus = s.records[existingIdx].status;
            s.records.splice(existingIdx, 1);
        }

        s.records.push({
            week, day: document.getElementById('gDay').value,
            page, mark, status, note, prevStatus: (status === 'ุญุงูุธ' && prevStatus) ? prevStatus : null
        });

        db.ref('students/' + currentSID + '/records').set(s.records).then(() => {
            alert('ุชู ุงูุฑุตุฏ ุจูุฌุงุญ');
            showScreen('teacherDash');
        });
    }

    function staffAuth() {
        const u = document.getElementById('user').value;
        const p = document.getElementById('pass').value;
        if(u === 'saad' && p === 'ุณุนุฏ ุงูููู ู ุณุชู ู ุนุดุฑูู') showScreen('teacherDash');
        else if(u === 'admin' && p === 'ุงุฏูู 2026') { renderAdminDash('3/1'); showScreen('adminDash'); }
        else alert('ุฎุทุฃ ูู ุจูุงูุงุช ุงูุฏุฎูู!');
    }

    function filterStudents() {
        const term = document.getElementById('searchStudent').value.toLowerCase();
        const items = document.querySelectorAll('.grid-item');
        items.forEach(it => {
            it.style.display = it.innerText.toLowerCase().includes(term) ? 'flex' : 'none';
        });
    }

    function loadClass(cls) {
        currentClass = cls;
        const grid = document.getElementById('namesGrid'); grid.innerHTML = "";
        students.filter(x => x.class === cls).forEach(s => {
            const div = document.createElement('div'); div.className = "grid-item";
            div.innerText = s.name;
            div.onclick = () => { currentSID = s.id; document.getElementById('targetName').innerText = `ุฑุตุฏ ูู: ${s.name}`; renderHistoryTeacher(s); showScreen('gradeScreen'); };
            grid.appendChild(div);
        });
    }

    function renderAdminDash(cls) {
        let html = `<h4>ุชูุฑูุฑ ูุตู ${cls}</h4>`;
        students.filter(x => x.class === cls).forEach(s => {
            html += `<div class="history-item">
                <b>${s.name} (ุงูููุชุงุญ: ${s.code})</b><br>
                <small>ุขุฎุฑ ุชุณููุน: ${(s.records || []).slice(-1)[0]?.status || 'ูุง ููุฌุฏ'}</small>
            </div>`;
        });
        document.getElementById('adminContainer').innerHTML = html;
    }

    function renderHistoryTeacher(s) {
        document.getElementById('historyListTeacher').innerHTML = (s.records || []).map((r, i) => `
            <div style="font-size:11px; padding:5px; border-bottom:1px solid #eee; display:flex; justify-content:space-between">
                <span>${r.week} | ุต ${r.page} | ${r.status}</span>
                <button onclick="deleteRecord(${i})" style="color:red; border:none; background:none; cursor:pointer">ุญุฐู</button>
            </div>
        `).join('');
    }

    function deleteRecord(i) {
        if(confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐู ุงูุฏุฑุฌุฉุ')) {
            const s = students.find(x => x.id == currentSID);
            s.records.splice(i, 1);
            db.ref('students/' + currentSID + '/records').set(s.records).then(() => renderHistoryTeacher(s));
        }
    }

    function addNewStudent() {
        const id = Date.now();
        const name = document.getElementById('newSName').value;
        const code = document.getElementById('newSCode').value;
        const cls = document.getElementById('newSClass').value;
        if(name && code) db.ref('students/' + id).set({ id, name, code, class: cls }).then(() => { alert('ุชูุช ุงูุฅุถุงูุฉ'); document.getElementById('newSName').value=''; });
    }

    function getColor(s) { return {'ุญุงูุธ':'#2ecc71', 'ุบูุฑ ุญุงูุธ':'#f1c40f', 'ูู ูุณูุน':'#e67e22', 'ูุญุฑูู':'#e74c3c', 'ุบุงุฆุจ':'#95a5a6'}[s] || '#3498db'; }
    function showScreen(id) { document.querySelectorAll('#app > div').forEach(d => d.classList.add('hidden')); document.getElementById(id).classList.remove('hidden'); }
    function toggleTopTen() { const el = document.getElementById('topTenList'); el.style.display = el.style.display === 'none' ? 'block' : 'none'; updateTopTen(); }
    
    function updateTopTen() {
        const sorted = [...students].sort((a,b) => (b.records?.length || 0) - (a.records?.length || 0)).slice(0, 10);
        document.getElementById('topTenList').innerHTML = sorted.map((s, i) => `<div>${i+1}. ${s.name} (${s.records?.length || 0} ุฏุฑุณ)</div>`).join('');
    }
    
    function resetTopTen() { if(confirm('ูู ุชุฑูุฏ ุชุตููุฑ ุฅุญุตุงุฆูุงุช ุงูุฃูุงุฆูุ')) alert('ุชู ุทูุจ ุชุตููุฑ ุงูุฅุญุตุงุฆูุงุช (ูุชุทูุจ ูุณุญ ุงูุณุฌูุงุช)'); }
</script>
</body>
</html>
